
Container Image Vulnerability Checker and Image Recommender using Twistlock and Synk:
--------------------------------------------------------------------------------------

This library is designed to check the vulnerabilites that exists in the vendor images and bitnami images and to recommend the better image with lesser vulnerabilities.

Images that are to compared can be configured in the config.json file

{
    
    "login": " -u <<username>>  -p  <<password>>", // docker login

    "ms-dotnet-runtime" : "mcr.microsoft.com/dotnet/core/aspnet:3.1-alpine",
    "ms-dotnet-sdk" : "mcr.microsoft.com/dotnet/core/sdk:3.1-alpine",

    "bitnami-dotnet-runtime" : "docker.io/bitnami/aspnet-core:3.1",
    "bitnami-dotnet-sdk" : "docker.io/bitnami/dotnet-sdk:3.1",

    "build-ms-dotnetapp-3.1": " -f ./dotnetapp-3.1/ms.Dockerfile  -t mvbalamca/vulnerability-checker-nodejs:dotnet3.1-ms .",
    "build-bitnami-dotnetapp-3.1": " -f ./dotnetapp-3.1/bitnami.Dockerfile  -t mvbalamca/vulnerability-checker-nodejs:dotnet3.1-bitnami .",
    
    "ms-dotnetapp-3.1": "mvbalamca/vulnerability-checker-nodejs:dotnet3.1-ms",
    "bitnami-dotnetapp-3.1": "mvbalamca/vulnerability-checker-nodejs:dotnet3.1-bitnami",
    
    "snyk-ms-scan-result":"./scan-results/snyk-ms-scan-result.txt",
    "snyk-bitnami-scan-result":"./scan-results/snyk-bitnami-scan-result.txt",

    "twistlock-ms-scan-result":"./scan-results/twistlock-ms-scan-result.txt",
    "twistlock-bitnami-scan-result":"./scan-results/twistlock-bitnami-scan-result.txt"
}

---------------------------------------------------------------------------------------------------------------------------------------

Usage:
npm run install
npm run test

 PASS  __tests__/TestRunner.test.ts (489.403 s)
  sequentially run tests
    docker ops function
      ✓ docker login... (24666 ms)
      ✓ Pull test Docker image... (6433 ms)
      ✓ Pull ms-dotnet-runtime Docker image... (25475 ms)
      ✓ Pull ms-dotnet-sdk Docker image... (52738 ms)
      ✓ Pull bitnami-dotnet-runtime Docker image... (71164 ms)
      ✓ Pull bitnami-dotnet-sdk Docker image... (96172 ms)
      ✓ Build ms-dotnet3.1-app Docker image... (17016 ms)
      ✓ Build bitnami-dotnet3.1-app Docker image... (26219 ms)
      ✓ docker logout... (5825 ms)
    docker container scan function
      ✓ docker login... (10070 ms)
      ✓ Twistlock Scan MS Docker image... (18469 ms)
      ✓ Twistlock Scan Bitnami Docker image... (17101 ms)
      ✓ Snyk Scan MS Docker image... (14031 ms)
      ✓ Snyk Scan Bitnami Docker image... (42979 ms)
      ✓ docker logout... (2849 ms)
    docker vulnerability checker function
      ✓ Vulnerability checker... (119 ms)

---------------------------------------------------------------------------------------------------------------------------------------

Steps performed :
a. Docker login to docker repository
b. Docker Pull the configured images for ms-dotnet and Bitnami-dotnet
c. Docker Build using the pulled images
d. Container Scan for the Bitnami and ms images
f. Vulnerability check for Bitnami Images and write the scan results to a file
g. Vulnerability check for Ms Images and write the scan results to a file
h. Compare the results from the file
d. Arrive at recommeded image using the vulnerability counts.

---------------------------------------------------------------------------------------------------------------------------------------

SCAN RESULTS:

SYNK BITNAMI SCAN RESULTS:

Testing mvbalamca/vulnerability-checker-nodejs:dotnet3.1-bitnami...

✗ Critical severity vulnerability found in glibc/libc6-dev
  Description: Integer Overflow or Wraparound
  Info: https://snyk.io/vuln/SNYK-DEBIAN10-GLIBC-1315333
  Introduced through: icu/libicu-dev@63.1-6+deb10u1, sqlite3/libsqlite3-dev@3.27.2-3+deb10u1, build-essential@12.6, ust/liblttng-ust-dev@2.10.3-1, glibc/libc-bin@2.28-10, meta-common-packages@meta
  From: icu/libicu-dev@63.1-6+deb10u1 > glibc/libc6-dev@2.28-10
  From: sqlite3/libsqlite3-dev@3.27.2-3+deb10u1 > glibc/libc6-dev@2.28-10
  From: build-essential@12.6 > glibc/libc6-dev@2.28-10
  and 5 more...

Organization:      mvbalamca
Package manager:   deb
Project name:      docker-image|mvbalamca/vulnerability-checker-nodejs
Docker image:      mvbalamca/vulnerability-checker-nodejs:dotnet3.1-bitnami
Platform:          linux/amd64
Base image:        bitnami/minideb:buster
Licenses:          enabled

Tested 171 dependencies for known issues, found 151 issues.
---------------------------------------------------------------------------------------------------------------------------------------
SYNK MS SCAN RESULTS:

Testing mvbalamca/vulnerability-checker-nodejs:dotnet3.1-ms...

✗ Low severity vulnerability found in apk-tools/apk-tools
  Description: CVE-2021-36159
  Info: https://snyk.io/vuln/SNYK-ALPINE313-APKTOOLS-1533754
  Introduced through: apk-tools/apk-tools@2.12.5-r0
  From: apk-tools/apk-tools@2.12.5-r0
  Fixed in: 2.12.6-r0



Organization:      mvbalamca
Package manager:   apk
Project name:      docker-image|mvbalamca/vulnerability-checker-nodejs
Docker image:      mvbalamca/vulnerability-checker-nodejs:dotnet3.1-ms
Platform:          linux/amd64
Base image:        alpine:3.13
Licenses:          enabled

Tested 23 dependencies for known issues, found 1 issue.
---------------------------------------------------------------------------------------------------------------------------------------

TWISTLOCK BITNAMI SCAN RESULTS:

{
	"results": [
		{
			"id": "sha256:c25545af59d3edd1c617f9f9fbd3ab1aedd3897e3f94c5066a63e703bfb45eec",
			"name": "mvbalamca/vulnerability-checker-nodejs:dotnet3.1-bitnami",
			"distro": "Debian GNU/Linux 10 (buster)",
			"distroRelease": "buster",
			"collections": [
				"All"
			],
			"packages": [
				 .......
			],
			"vulnerabilityDistribution": {
				"critical": 0,
				"high": 2,
				"medium": 0,
				"low": 38,
				"total": 40
			},
			"vulnerabilityScanPassed": true
		}
	]
}
---------------------------------------------------------------------------------------------------------------------------------------
TWISTLOCK MS SCAN RESULTS:

{
	"results": [
		{
			"id": "sha256:4fe17df1157e0bb3989436a66211d3fe144587c68834b96c6406205d189730fc",
			"name": "mvbalamca/vulnerability-checker-nodejs:dotnet3.1-ms",
			"distro": "Alpine Linux v3.13",
			"distroRelease": "3.13.5",
			"collections": [
				"All"
			],
			"packages": [
				 ........
			],
			"vulnerabilityDistribution": {
				"critical": 0,
				"high": 0,
				"medium": 0,
				"low": 1,
				"total": 1
			},
			"vulnerabilityScanPassed": true
		}
	]
}
---------------------------------------------------------------------------------------------------------------------------------------
    Twistlock  Scan Statistics report:

    Bitnami Total Vulnerability Count  :  40
    Bitnami Critial Vulnerability Count  :  0
    Bitnami High Vulnerability Count  :  2
    Bitnami Medium Vulnerability Count  :  0
    Bitnami Low Vulnerability Count  :  38
    -------------------------------------
    MS Total Vulnerability Count  :  1
    MS Critial Vulnerability Count  :  0
    MS High Vulnerability Count  :  0
    MS Medium Vulnerability Count  :  0
    MS Low Vulnerability Count  :  1
    -----------------------------------------------
    Twistlock  Scan Recommended Image :  microsoft
    -----------------------------------------------

    Synk Scan Statistics report :

    Bitnami Total Vulnerability Count  :  149
    Bitnami Critial Vulnerability Count  :  0
    Bitnami High Vulnerability Count  :  13
    Bitnami Medium Vulnerability Count  :  9
    Bitnami Low Vulnerability Count  :  127
    -------------------------------------
    MS Total Vulnerability Count  :  1
    MS Critial Vulnerability Count  :  0
    MS High Vulnerability Count  :  0
    MS Medium Vulnerability Count  :  0
    MS Low Vulnerability Count  :  1
    -----------------------------------------------
    Synk Scan Recommended Image :  microsoft
    -----------------------------------------------

---------------------------------------------------------------------------------------------------------------------------------------